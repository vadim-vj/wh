# Общие замечания о `git`

- работает с состояниями всего репозитория, не отдельных файлов
- является контентно-адресуемой файловой системой (ФС)
- использует ФС-независимые ссылки - текстовые файлы с префиксом и путем/ссылкой:
  - `git`-ссылки (`gitdir: <dir>`)
  - `HEAD` - указатель на ветку (`ref: refs/heads/<branch>`)
- файл `.git/index` является манифестом - списком упорядоченных хешей и статистических данных о файлах; оптимизирован для быстрого сравнения/генерации деревьев файлов

# git-help

Вывод справки.
- `git help` === `git` - без аргументов печатает синопсис команды `git` и список наиболее распространенных команд
- `git help -a|--all` - синопсис + все команды
- `git help -a|--all --verbose` - синопсис + все команды + описание команд; опция `--verbose` действует только вместе с `-a|--all`
- `git help -c|--config` - список имен всех опций конфига (без значений); это краткое summary `git config`
- `git help -g|--guides` - список гайдов
---
- `git help <command|guide>` === `git --help <command|guide>` === `git <command> --help` - третий вариант не действует для гайдов
- `man git-<command>` - действует только для команд (не для гайдов), и игнорирует настройки просмотрщика (см. далее)
---
- опция конфига - `help.format={man|info|web}` - просмотрщик
- `git help -m|--man <command|guide>` - для перекрытия значения из конфига и использования стандартного просмотрщика `man`
- `git help -i|--info <command|guide>` - в формате `info` найти документацию на `git` не удалось
- `git help -w|--web <command|guide>` - в браузере
---
- `git help help` - справка по команде `help`
- `git help git` - по основной команде `git`

# git-init

Инициализация репозитория: создание папки `.git` (и ничего кроме). Для существующего - обновление подпапок в `.git`. Это безопасно и используется в основном для подтягивания новых шаблонов и хуков, или для перемещения репозитория (опция `--separate-git-dir`).

---
По умолчанию выполняется в текущей папке. Команде можно указать директорию, тогда она будет выполнена в ней (если папка не существует, она будет создана): `git init ./test`

---
Переменные окружения по умолчанию не установлены, и их дефолтные значения хранятся в самом `git`-е (`echo $GIT...` выдаст пустую строку):
- `$GIT_DIR=./.git`
- `$GIT_OBJECT_DIRECTORY=$GIT_DIR/objects`
- `$GIT_TEMPLATE_DIR=--template=<dir>=init.templateDir=/usr/share/git-core/templates`
---
По умолчанию в `.git` создается структура:
```
./HEAD
./config
./refs
./refs/tags
./refs/heads
./objects
./objects/pack
./objects/info
```
`config` непуст, `HEAD` ссылается на (пока) не существующий `master`, остальное - пустые папки.

---
Если не указано пустое значение для папки шаблонов, то дополнительно создается структура
```
./branches
./hooks
./hooks/*.sample
./description
./info
./info/exclude
```
Файл `description` содержит текст `Unnamed repository; edit this file 'description' to name the repository.` (для графических утилит). `info/exclude` - глобальные исключения. Из папки шаблонов в `.git` будут скопированы все файлы, не начинающиеся с точки. Для применения хуков нужно их переименовывать, убирая расширение `.sample`

---
- `git init -q|--quiet` - только ошибки и предупреждения
- `git init --bare` - создает голый репозиторий. Если $GIT_DIR или опция пути не указаны, то создается в текущей папке
- `git --template=<dir>` - указывает папку шаблонов
- `git --separate-git-dir=<dir>` - создает структуру в указанной папке, а в текущей создает `git`-ссылку (файл с текстом `gitdir: <dir>`) на нее. Может использоваться на существующем репозитории для перемещения папки `.git` (при перемещении также создается `git`ссылка на новую локацию). Пример:
```
./.git (link -> .test)
./.test
./.test/HEAD
./.test/config
...
```
- `git --shared[=(false|true|umask|group|all|world|everybody|0xxx)]` - дает права на репу группе пользователей (подпапки в `.git` создаются с нужными правами)
